<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Al-Baiquniyah</title>
    
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@400;500;600;700&family=Amiri:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            font-family: 'Plus Jakarta Sans', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        
        .font-arabic {
            font-family: 'Amiri', serif;
            line-height: 2.2;
        }

        /* Glassmorphism Card */
        .glass-card {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.5);
            box-shadow: 0 10px 40px -10px rgba(0, 0, 0, 0.05);
        }

        /* Animation */
        .fade-enter { opacity: 0; transform: scale(0.98); }
        .fade-enter-active { opacity: 1; transform: scale(1); transition: opacity 300ms, transform 300ms; }
        
        /* Checkbox Custom */
        .checkbox-wrapper input:checked + div {
            background-color: #10b981;
            border-color: #10b981;
        }
        .checkbox-wrapper input:checked + div svg {
            display: block;
        }
    </style>
    
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        primary: { 500: '#0d9488', 600: '#0f766e', 50: '#f0fdfa' }, // Teal
                        accent: { 500: '#f59e0b', 100: '#fef3c7' } // Amber
                    }
                }
            }
        }
    </script>
</head>
<body class="min-h-screen bg-slate-50 selection:bg-primary-100 selection:text-primary-600">

    <div id="root"></div>

    <script type="text/babel">
        // --- ICONS ---
        const Icons = {
            BookOpen: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253" /></svg>,
            CheckCircle: () => <svg className="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
            Clock: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
            Play: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M14.752 11.168l-3.197-2.132A1 1 0 0010 9.87v4.263a1 1 0 001.555.832l3.197-2.132a1 1 0 000-1.664z" /><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M21 12a9 9 0 11-18 0 9 9 0 0118 0z" /></svg>,
            ChevronLeft: () => <svg className="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="2" d="M15 19l-7-7 7-7" /></svg>,
            Check: () => <svg className="w-3 h-3 text-white" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path strokeLinecap="round" strokeLinejoin="round" strokeWidth="3" d="M5 13l4 4L19 7" /></svg>
        };

        // --- DATA NADZOM (34 Bait) ---
        const nadzomData = [
            { id: 1, ar: "أَبْدَأُ بِالْحَمْدِ مُصَلِّياً عَلَى ... مُحَمَّدٍ خَيْرِ نَبِيٍّ أُرْسِلا", tr: "Aku memulai dengan memuji (Allah) bershalawat atas Muhammad, sebaik-baik Nabi yang diutus." },
            { id: 2, ar: "وَذِي مِنَ أقْسَامِ الحَدِيثِ عِدَّه ... وَكُلُّ وَاحِدٍ أَتَى وَحَدَّه", tr: "Dan ini adalah sejumlah pembagian hadis, dan setiap bagian datang beserta definisinya." },
            { id: 3, ar: "أَوَّلُهَا الصَّحِيحُ وَهْوَ مَا اتَّصَلْ ... إِسْنَادُهُ وَلَمْ يَشُذَّ أَوْ يُعَلْ", tr: "Pertama adalah Shahih, yaitu yang bersambung sanadnya dan tidak syadz (janggal) atau ber-illat (cacat)." },
            { id: 4, ar: "يَرْوِيهِ عَدْلٌ ضَابِطٌ عَنْ مِثْلِهِ ... مُعْتَمَدٌ فِي ضَبْطِهِ وَنَقْلِهِ", tr: "Diriwayatkan oleh perawi adil dan dhabit dari yang semisalnya, yang diandalkan dalam kedhabitan dan penukilannya." },
            { id: 5, ar: "وَالْحَسَنُ الْمَعْرُوفُ طُرْقاً وَغَدَتْ ... رِجَالُهُ لاَ كَالصَّحِيحِ اشْتَهَرَتْ", tr: "Dan Hasan adalah yang dikenal jalan periwayatannya, namun para perawinya tidak sepopuler perawi hadis shahih." },
            { id: 6, ar: "وَكُلُّ مَا عَنْ رُتْبَةِ الحُسْنِ قَصُرْ ... فَهْوَ الضَّعِيفُ وَهُوَ أقْسَاماً كُثُرْ", tr: "Dan setiap yang kurang dari tingkatan Hasan, maka itu adalah Dhaif, dan ia mempunyai banyak pembagian." },
            { id: 7, ar: "وَمَا أُضِيفَ لِلنَّبِي الْمَرْفُوعُ ... وَمَا لِتَابِعٍ هُوَ الْمَقْطُوعُ", tr: "Apa yang disandarkan kepada Nabi adalah Marfu', dan yang disandarkan kepada Tabi'in adalah Maqthu'." },
            { id: 8, ar: "وَالْمُسْنَدُ الْمُتَّصِلُ الْمَسْمُوعُ ... إِسْنَادُهُ مِنْ رَاوِيهِ حَتَّى الْمُصْطَفَى", tr: "Musnad adalah yang bersambung dan didengar sanadnya dari perawinya hingga Al-Musthafa (Nabi)." },
            { id: 9, ar: "وَمَا بِسَمْعِ كُلِّ رَاوٍ يَتَّصِلْ ... إِسْنَادُهُ لِلْمُصْطَفَى فَالْمُتَّصِلْ", tr: "Apa yang dengan pendengaran setiap perawi bersambung sanadnya kepada Al-Musthafa, maka itu Muttashil." },
            { id: 10, ar: "مُسَلْسَلٌ قُلْ مَا عَلَى وَصْفٍ أَتَى ... مِثْلُ أَمَا وَاللهِ أَنْبَأَنِي الْفَتَى", tr: "Musalsal katakanlah: apa yang datang dengan sifat tertentu, seperti: 'Ingatlah, demi Allah, pemuda itu memberitahuku'." },
            { id: 11, ar: "كَذَاكَ قَدْ حَدَّثَنِيهِ قَائِمَا ... أَوْ بَعْدَ أَنْ حَدَّثَنِي تَبَسَّمَا", tr: "Begitu juga: 'Dia menceritakannya kepadaku sambil berdiri', atau 'setelah menceritakan padaku, dia tersenyum'." },
            { id: 12, ar: "عَزِيزٌ مَرْوِيُّ اثْنَيْنِ أَوْ ثَلاَثَهْ ... مَشْهُورٌ مَرْوِيُّ فَوْقَ مَا ثَلاَثَهْ", tr: "Aziz adalah yang diriwayatkan oleh dua atau tiga orang. Masyhur adalah yang diriwayatkan lebih dari tiga orang." },
            { id: 13, ar: "مُعَنْعَنٌ كَعَن سَعِيدٍ عَنْ كَرَمْ ... وَمُبْهَمٌ مَا فِيهِ رَاوٍ لَمْ يُسَمْ", tr: "Mu'an'an seperti 'Dari Sa'id dari Karam'. Dan Mubham adalah yang di dalamnya ada perawi tak bernama." },
            { id: 14, ar: "وَكُلُّ مَا قَلَّتْ رِجَالُهُ عَلاَ ... وَضِدُّهُ ذَاكَ الَّذِي قَدْ نَزَلاَ", tr: "Setiap yang sedikit jumlah perawinya, itu 'Ali (Tinggi). Dan lawannya adalah yang Nazil (Rendah)." },
            { id: 15, ar: "وَمَا أَضَفْتَهُ إِلَى الأَصْحَابِ مِنْ ... قَوْلٍ وَفِعْلٍ فَهْوَ مَوْقُوفٌ زُكِنْ", tr: "Apa yang kau sandarkan kepada Sahabat berupa perkataan dan perbuatan, maka itu Mauquf, pahamilah." },
            { id: 16, ar: "وَمُرْسَلٌ مِنْهُ الصَّحَابِيُّ سَقَطْ ... وَقُلْ غَرِيبٌ مَا رَوَى رَاوٍ فَقَطْ", tr: "Murshal adalah yang gugur Sahabat darinya. Dan katakanlah Gharib untuk yang diriwayatkan satu orang saja." },
            { id: 17, ar: "وَكُلُّ مَا لَمْ يَتَّصِلْ بِحَالِ ... إِسْنَادُهُ مُنْقَطِعُ الأَوْصَالِ", tr: "Setiap yang tidak bersambung sama sekali sanadnya, adalah Munqathi' (terputus) sendi-sendinya." },
            { id: 18, ar: "وَالْمُعْضَلُ السَّاقِطُ مِنْهُ اثْنَانِ ... وَمَا أَتَى مُدَلَّساً نَوْعَانِ", tr: "Mu'dhal adalah yang gugur darinya dua orang (berurut). Dan yang datang secara Mudallas ada dua jenis." },
            { id: 19, ar: "الأَوَّلُ الإِسْقَاطُ لِلشَّيْخِ وَأَنْ ... يَنْقُلَ عَمَّنْ فَوْقَهُ بِعَنْ وَأَنْ", tr: "Pertama: Menggugurkan guru dan menukil dari yang di atasnya dengan lafaz 'An' dan 'Anna'." },
            { id: 20, ar: "وَالثَّانِ لاَ يُسْقِطُهُ لَكِنْ يَصِفْ ... أَوْصَافَهُ بِمَا بِهِ لاَ يَنْعَرِفْ", tr: "Kedua: Tidak menggugurkannya, tapi menyifati sifat-sifatnya dengan yang tidak dikenal darinya." },
            { id: 21, ar: "وَمَا يُخَالِفْ ثِقَةٌ فِيهِ الْمَلأ ... فَالشَّاذُّ وَالْمَقْلُوبُ قِسْمَانِ تَلا", tr: "Apa yang seorang tsiqah menyelisih orang banyak, maka itu Syadz. Dan Maqlub ada dua bagian yang mengiringi." },
            { id: 22, ar: "إِبْدَالُ رَاوٍ مَا بِرَاوٍ قِسْمُ ... وَقَلْبُ إِسْنَادٍ لِمَتْنٍ قِسْمُ", tr: "Mengganti seorang perawi dengan perawi lain adalah satu bagian. Dan membalik sanad untuk suatu matan adalah satu bagian." },
            { id: 23, ar: "وَالْفَرْدُ مَا قَيَّدْتَهُ بِثِقَةِ ... أَوْ جَمْعٍ أَوْ قَصْرٍ عَلَى رِوَايَةِ", tr: "Dan Fard adalah apa yang kau batasi dengan orang tsiqah, atau jamaah atau pembatasan pada riwayat tertentu." },
            { id: 24, ar: "وَمَا بِعِلَّةٍ غُمُوضٍ أَوْ خَفَا ... مُعَلَّلٌ عِنْدَهُمُ قَدْ عُرِفَا", tr: "Dan apa yang memiliki cacat samar atau tersembunyi, dikenal di sisi mereka sebagai Mu'allal." },
            { id: 25, ar: "وَذُو اخْتِلاَفِ سَنَدٍ أَوْ مَتْنِ ... مُضْطَرِبٌ عِنْدَ أُهَيْلِ الْفَنِّ", tr: "Dan yang memiliki perbedaan sanad atau matan, adalah Mudhtharib menurut ahli hadis." },
            { id: 26, ar: "وَالْمُدْرَجَاتُ فِي الحَدِيثِ مَا أَتَتْ ... مِنْ بَعْضِ أَلْفَاظِ الرُّوَاةِ اتَّصَلَتْ", tr: "Dan Mudrajat dalam hadis adalah yang datang dari sebagian lafaz perawi yang bersambung (dengan matan)." },
            { id: 27, ar: "وَمَا رَوَى كُلُّ قَرِينٍ عَنْ أَخِهْ ... مُدَبَّجٌ فَاعْرِفْهُ حَقًّا وَانْتَخِهْ", tr: "Dan apa yang diriwayatkan setiap kawan dari saudaranya, adalah Mudabbaj, maka kenalilah dengan benar dan banggalah." },
            { id: 28, ar: "مُتَّفِقٌ لَفْظاً وَخَطاً مُتَّفِقْ ... وَضِدُّهُ فِيمَا ذَكَرْنَا الْمُفْتَرِقْ", tr: "Muttafiq adalah yang lafaz dan tulisannya sama. Dan lawannya dalam yang kami sebutkan adalah Muftariq." },
            { id: 29, ar: "مُؤْتَلِفٌ مُتَّفِقُ الخَطِّ فَقَطْ ... وَضِدُّهُ مُخْتَلِفُ فَاخْشَ الْغَلَطْ", tr: "Mu'talif adalah yang sama tulisannya saja. Dan lawannya Mukhtalif, maka takutlah salah." },
            { id: 30, ar: "وَالْمُنْكَرُ الْفَرْدُ بِهِ رَاوٍ غَدَا ... تَعْدِيلُهُ لاَ يَحْمِلُ التَّفَرُّدَا", tr: "Dan Munkar adalah yang seorang perawi bersendiri dengannya, yang keadilannya tidak bisa menanggung kesendirian itu." },
            { id: 31, ar: "مَتْرُوكُهُ مَا وَاحِدٌ بِهِ انْفَرَدْ ... وَأَجْمَعُوا لِضَعْفِهِ فَهُوَ كَرَدْ", tr: "Matruk adalah yang satu orang bersendiri dengannya, dan mereka sepakat atas kelemahannya, maka ia tertolak." },
            { id: 32, ar: "وَالْكَذِبُ الْمُخْتَلَقُ المَصْنُوعُ ... عَلَى النَّبِيِّ فَذَلِكَ الْمَوْضُوعُ", tr: "Dan dusta yang direkayasa dan dibuat-buat atas nama Nabi, maka itulah Maudhu'." },
            { id: 33, ar: "وَقَدْ أَتَتْ كَالْجَوْهَرِ المَكْنُونِ ... سَمَّيْتُهَا مَنْظُومَةَ الْبَيْقُونِي", tr: "Dan ia telah datang bagaikan mutiara yang tersimpan, aku namakan ia Manzhumah Baiquni." },
            { id: 34, ar: "فَوْقَ الثَّلاَثِينَ بِأَرْبَعٍ أَتَتْ ... أبيَاتُهَا تَمَّتْ بِخَيْرٍ خُتِمَتْ", tr: "Ia datang lebih empat di atas tiga puluh (34 bait), bait telah sempurna, ditutup dengan kebaikan." }
        ];

        // --- DATA SOAL (Strict Matn Base) ---
        const questionsData = [
            { type: "nadzom", question: "أكمل: أَبْدَأُ بِالْحَمْدِ مُصَلِّياً عَلَى ...", options: ["مُحَمَّدٍ خَيْرِ نَبِيٍّ أُرْسِلا", "نَبِيِّنَا الْمُصْطَفَى خَيْرِ الْوَرَى", "وَآلِهِ وَصَحْبِهِ وَمَنْ تَلَا"], answer: "مُحَمَّدٍ خَيْرِ نَبِيٍّ أُرْسِلا" },
            { type: "nadzom", question: "أكمل: وَذِي مِنَ أقْسَامِ الحَدِيثِ عِدَّه ...", options: ["وَكُلُّ وَاحِدٍ أَتَى وَحَدَّه", "وَنَظْمُهَا جَاءَكَ فِي عُجَالَة", "خُذْهَا هَدِيَّةً مِنَ الرِّسَالَة"], answer: "وَكُلُّ وَاحِدٍ أَتَى وَحَدَّه" },
            { type: "tarif", question: "بم عرف الناظم الحديث الصحيح؟", options: ["ما اتصل سنده ولم يشذ أو يعل", "ما رواه العدل الضابط عن مثله فقط", "ما صح سنده ومتنه عند العلماء"], answer: "ما اتصل سنده ولم يشذ أو يعل" },
            { type: "nadzom", question: "أكمل وصف راوي الصحيح: يَرْوِيهِ عَدْلٌ ضَابِطٌ عَنْ مِثْلِهِ ...", options: ["مُعْتَمَدٌ فِي ضَبْطِهِ وَنَقْلِهِ", "مُشْتَهَرٌ بِالصِّدْقِ فِي مَقَالِهِ", "وَلَيْسَ فِي إِسْنَادِهِ مَا يُكْرَهُ"], answer: "مُعْتَمَدٌ فِي ضَبْطِهِ وَنَقْلِهِ" },
            { type: "tarif", question: "الحديث الحسن عند الناظم هو:", options: ["المعروف طرقاً وغدت رجاله لا كالصحيح اشتهرت", "ما اتصل سنده بنقل العدل الضابط", "ما خف ضبط راويه"], answer: "المعروف طرقاً وغدت رجاله لا كالصحيح اشتهرت" },

            // Dhaif
            { type: "nadzom", question: "أكمل: وَكُلُّ مَا عَنْ رُتْبَةِ الحُسْنِ قَصُرْ ...", options: ["فَهْوَ الضَّعِيفُ وَهُوَ أقْسَاماً كُثُرْ", "فَذَاكَ مَتْرُوكٌ وَلَا يُحْتَجُّ بِهْ", "فَإِنَّهُ الْمَوْضُوعُ شَرُّ الْخَبَرِ"], answer: "فَهْوَ الضَّعِيفُ وَهُوَ أقْسَاماً كُثُرْ" },

            // Marfu, Maqthu, Musnad, Muttashil
            { type: "tarif", question: "الحديث المرفوع هو ما أضيف إلى:", options: ["النبي ﷺ", "الصحابي", "التابعي"], answer: "النبي ﷺ" },
            { type: "tarif", question: "الحديث المقطوع هو ما أضيف إلى:", options: ["التابعي", "النبي ﷺ", "الصحابي"], answer: "التابعي" },
            { type: "tarif", question: "الحديث المسند هو:", options: ["المتصل الإسناد من راويه حتى المصطفى", "ما رواه الجماعة عن الجماعة", "ما اتصل سنده بغير انقطاع"], answer: "المتصل الإسناد من راويه حتى المصطفى" },
            { type: "nadzom", question: "أكمل: وَمَا بِسَمْعِ كُلِّ رَاوٍ يَتَّصِلْ ...", options: ["إِسْنَادُهُ لِلْمُصْطَفَى فَالْمُتَّصِلْ", "فَذَاكَ مَقْطُوعٌ بِهِ قَدْ انْضَبَطْ", "إِسْنَادُهُ مُنْقَطِعُ الأَوْصَالِ"], answer: "إِسْنَادُهُ لِلْمُصْطَفَى فَالْمُتَّصِلْ" },

            // Musalsal, Aziz, Masyhur
            { type: "tarif", question: "الحديث المسلسل هو ما تتابع فيه الرواة على:", options: ["وصف معين أو حالة معينة", "اسم معين", "بلد معين"], answer: "وصف معين أو حالة معينة" },
            { type: "nadzom", question: "أكمل المثال: مِثْلُ أَمَا وَاللهِ أَنْبَأَنِي الْفَتَى ...", options: ["كَذَاكَ قَدْ حَدَّثَنِيهِ قَائِمَا", "أَوْ بَعْدَ أَنْ حَدَّثَنِي تَبَسَّمَا", "وَقَالَ لِي يَا صَاحِبي قَدْ فَهِمَا"], answer: "كَذَاكَ قَدْ حَدَّثَنِيهِ قَائِمَا" },
            { type: "tarif", question: "الحديث العزيز هو ما رواه:", options: ["اثنان أو ثلاثة", "واحد فقط", "أكثر من ثلاثة"], answer: "اثنان أو ثلاثة" },
            
            // Mu'an'an, Mubham, Ali, Nazil
            { type: "nadzom", question: "أكمل: مُعَنْعَنٌ كَعَن سَعِيدٍ عَنْ كَرَمْ ...", options: ["وَمُبْهَمٌ مَا فِيهِ رَاوٍ لَمْ يُسَمْ", "وَمُرْسَلٌ مِنْهُ الصَّحَابِيُّ سَقَطْ", "وَمَا أَتَى مُدَلَّساً نَوْعَانِ"], answer: "وَمُبْهَمٌ مَا فِيهِ رَاوٍ لَمْ يُسَمْ" },
            { type: "tarif", question: "الحديث العالي (علا) هو:", options: ["كل ما قلت رجاله", "كل ما كثرت رجاله", "ما صح سنده"], answer: "كل ما قلت رجاله" },

            // Mauquf, Mursal
            { type: "tarif", question: "الحديث الموقوف هو ما أضيف إلى:", options: ["الصحابي", "النبي ﷺ", "التابعي"], answer: "الصحابي" },
            { type: "nadzom", question: "أكمل: وَمُرْسَلٌ مِنْهُ الصَّحَابِيُّ سَقَطْ ...", options: ["وَقُلْ غَرِيبٌ مَا رَوَى رَاوٍ فَقَطْ", "وَقُلْ ضَعِيفٌ مَا رَوَى رَاوٍ فَقَطْ", "وَذَاكَ مَقْطُوعٌ بِهِ قَدْ انْضَبَطْ"], answer: "وَقُلْ غَرِيبٌ مَا رَوَى رَاوٍ فَقَطْ" },

            // Gharib, Munqathi, Mu'dhal
            { type: "tarif", question: "الحديث الغريب هو:", options: ["ما تفرد بروايته شخص واحد (راو فقط)", "ما كان متنه غريباً", "ما رواه الغرباء"], answer: "ما تفرد بروايته شخص واحد (راو فقط)" },
            { type: "tarif", question: "الحديث المنقطع هو:", options: ["كل ما لم يتصل إسناده بحال", "ما سقط منه الصحابي فقط", "ما سقط منه راويان على التوالي"], answer: "كل ما لم يتصل إسناده بحال" },
            { type: "nadzom", question: "أكمل: وَالْمُعْضَلُ السَّاقِطُ مِنْهُ ...", options: ["اثْنَانِ", "وَاحِدٌ", "ثَلاَثَةٌ"], answer: "اثْنَانِ" },

            // Mudallas
            { type: "tarif", question: "النوع الأول من التدليس (إسقاط الشيخ):", options: ["ينقل عمن فوقه بـ (عن) و (أن)", "يصف أوصافه بما لا ينعرف", "يغير اسم الشيخ"], answer: "ينقل عمن فوقه بـ (عن) و (أن)" },
            { type: "nadzom", question: "أكمل: وَالثَّانِ لاَ يُسْقِطُهُ لَكِنْ يَصِفْ ...", options: ["أَوْصَافَهُ بِمَا بِهِ لاَ يَنْعَرِفْ", "أَحْوَالَهُ بِمَا بِهِ قَدْ يَتَّصِفْ", "أَسْمَاءَهُ بِحَيْثُ لاَ يَنْكَشِفْ"], answer: "أَوْصَافَهُ بِمَا بِهِ لاَ يَنْعَرِفْ" },

            // Shadz, Maqlub
            { type: "tarif", question: "الحديث الشاذ هو:", options: ["ما خالف فيه الثقة الملأ (الناس)", "ما تفرد به الكذاب", "ما كثرت طرقه"], answer: "ما خالف فيه الثقة الملأ (الناس)" },
            { type: "tarif", question: "المقلوب قسمان: إبدال راو براو، و...:", options: ["قلب إسناد لمتن", "قلب الحروف", "قلب المعنى"], answer: "قلب إسناد لمتن" },

            // Fard, Mu'allal, Mudhtharib
            { type: "tarif", question: "الحديث الفرد هو:", options: ["ما قيدته بثقة أو جمع أو قصر على رواية", "ما رواه واحد فقط مطلقاً", "ما ليس له إلا طريق واحد"], answer: "ما قيدته بثقة أو جمع أو قصر على رواية" },
            { type: "tarif", question: "الحديث المعلل هو:", options: ["ما فيه علة غموض أو خفاء", "ما فيه علة ظاهرة", "ما انقطع إسناده"], answer: "ما فيه علة غموض أو خفاء" },
            { type: "nadzom", question: "أكمل: وَذُو اخْتِلاَفِ سَنَدٍ أَوْ مَتْنِ ...", options: ["مُضْطَرِبٌ عِنْدَ أُهَيْلِ الْفَنِّ", "مُخْتَلِفٌ عِنْدَ أُهَيْلِ الْفَنِّ", "فَذَاكَ شَاذٌ بَائِنٌ فَاسْتَغْنِ"], answer: "مُضْطَرِبٌ عِنْدَ أُهَيْلِ الْفَنِّ" },

            // Mudraj, Mudabbaj
            { type: "nadzom", question: "أكمل: وَالْمُدْرَجَاتُ فِي الحَدِيثِ مَا أَتَتْ ...", options: ["مِنْ بَعْضِ أَلْفَاظِ الرُّوَاةِ اتَّصَلَتْ", "مِنْ قَوْلِ بَعْضِ التَّابِعِينَ نُقِلَتْ", "فِي آخِرِ الْمَتْنِ وَقَدْ تَفَصَّلَتْ"], answer: "مِنْ بَعْضِ أَلْفَاظِ الرُّوَاةِ اتَّصَلَتْ" },
            { type: "tarif", question: "الحديث المدبج هو:", options: ["ما روى كل قرين عن أخيه", "ما رواه الشيخ عن تلميذه", "ما رواه التلميذ عن شيخه"], answer: "ما روى كل قرين عن أخيه" },

            // Muttafiq, Muftariq, Mu'talif, Mukhtalif
            { type: "tarif", question: "المتفق والمفترق هو:", options: ["متفق لفظاً وخطاً، ومفترق مسمى (شخصاً)", "متفق خطاً واختلف لفظاً", "مختلف لفظاً وخطاً"], answer: "متفق لفظاً وخطاً، ومفترق مسمى (شخصاً)" },
            { type: "nadzom", question: "أكمل: مُؤْتَلِفٌ مُتَّفِقُ الخَطِّ فَقَطْ ...", options: ["وَضِدُّهُ مُخْتَلِفُ فَاخْشَ الْغَلَطْ", "وَضِدُّهُ مُفْتَرِقُ فَاخْشَ الْغَلَطْ", "وَعَكْسُهُ مُخْتَلِفُ فَاخْشَ الشَّطَطْ"], answer: "وَضِدُّهُ مُخْتَلِفُ فَاخْشَ الْغَلَطْ" },

            // Munkar, Matruk, Maudhu'
            { type: "tarif", question: "الحديث المنكر (عند الناظم) هو:", options: ["الفرد الذي لا يحتمل تعديل راويه التفرد", "ما خالف فيه الثقة من هو أوثق منه", "ما اتفق العلماء على ضعفه"], answer: "الفرد الذي لا يحتمل تعديل راويه التفرد" },
            { type: "nadzom", question: "أكمل: مَتْرُوكُهُ مَا وَاحِدٌ بِهِ انْفَرَدْ ...", options: ["وَأَجْمَعُوا لِضَعْفِهِ فَهُوَ كَرَدْ", "وَلَمْ يَكُنْ عِنْدَهُمُ بِمُعْتَمَدْ", "وَكَانَ فِي رِوَايَةٍ لاَ يُعْتَضَدْ"], answer: "وَأَجْمَعُوا لِضَعْفِهِ فَهُوَ كَرَدْ" },
            { type: "tarif", question: "الحديث الموضوع هو:", options: ["الكذب المختلق المصنوع على النبي", "الحديث الضعيف جداً", "خطأ الراوي الثقة"], answer: "الكذب المختلق المصنوع على النبي" },

            // Penutup
            { type: "nadzom", question: "بماذا شبه الناظم منظومته؟", options: ["كَالْجَوْهَرِ المَكْنُونِ", "كَاللُّؤْلُؤِ الْمَنْثُورِ", "كَالذَّهَبِ الْمَوْزُونِ"], answer: "كَالْجَوْهَرِ المَكْنُونِ" },
            { type: "nadzom", question: "كم عدد أبيات المنظومة؟", options: ["فوق الثلاثين بأربع (34)", "أربعون بيتاً (40)", "خمسون بيتاً (50)"], answer: "فوق الثلاثين بأربع (34)" }
        ];

        // --- COMPONENTS ---

        const Button = ({ children, onClick, variant = "primary", className = "", disabled = false, fullWidth = false }) => {
            let base = "px-4 py-3 rounded-xl font-bold transition-transform active:scale-95 flex items-center justify-center gap-2 select-none ";
            if (fullWidth) base += "w-full ";
            
            if (variant === "primary") base += "bg-primary-600 text-white shadow-lg shadow-primary-200 hover:bg-primary-700 ";
            if (variant === "secondary") base += "bg-white text-slate-700 border border-slate-200 hover:bg-slate-50 ";
            if (variant === "outline") base += "border-2 border-primary-500 text-primary-600 hover:bg-primary-50 ";
            if (variant === "ghost") base += "text-slate-500 hover:bg-slate-100 hover:text-slate-700 ";
            
            return (
                <button onClick={onClick} disabled={disabled} className={`${base} ${className} disabled:opacity-50 disabled:scale-100`}>
                    {children}
                </button>
            );
        };

        const Timer = ({ duration, onTimeUp, isActive }) => {
            const [timeLeft, setTimeLeft] = React.useState(duration);

            React.useEffect(() => {
                setTimeLeft(duration);
            }, [duration, isActive]); // Reset whenever duration or active state changes

            React.useEffect(() => {
                if (!isActive) return;
                
                const interval = setInterval(() => {
                    setTimeLeft((prev) => {
                        if (prev <= 1) {
                            clearInterval(interval);
                            onTimeUp();
                            return 0;
                        }
                        return prev - 1;
                    });
                }, 1000);

                return () => clearInterval(interval);
            }, [isActive, duration, onTimeUp]);

            const percentage = (timeLeft / duration) * 100;
            const color = timeLeft < 5 ? 'text-red-500' : 'text-primary-600';

            return (
                <div className="flex items-center gap-2 font-bold bg-white px-3 py-1.5 rounded-full shadow-sm border border-slate-100 relative overflow-hidden">
                    <div className="absolute bottom-0 left-0 h-1 bg-primary-500 transition-all duration-1000 ease-linear" style={{ width: `${percentage}%`, opacity: 0.3 }}></div>
                    <Icons.Clock />
                    <span className={color}>{timeLeft}s</span>
                </div>
            );
        };

        const PillOption = ({ label, selected, onClick }) => (
            <button 
                onClick={onClick}
                className={`flex-1 py-2 px-3 rounded-lg text-sm font-semibold transition-all border ${selected ? 'bg-primary-600 text-white border-primary-600 shadow-md' : 'bg-white text-slate-500 border-slate-200 hover:bg-slate-50'}`}
            >
                {label}
            </button>
        );

        // --- VIEWS ---

        // 1. HOME VIEW
        const HomeView = ({ onStart, onHifz }) => {
            const [count, setCount] = React.useState(10);
            const [timerDur, setTimerDur] = React.useState(20);
            const [type, setType] = React.useState('all');

            return (
                <div className="min-h-screen flex items-center justify-center p-6 fade-enter-active">
                    <div className="w-full max-w-md bg-white rounded-3xl shadow-xl p-8 text-center border-t-8 border-primary-500">
                        <div className="mb-4 flex justify-center">
                            <div className="bg-primary-50 p-4 rounded-full text-primary-600">
                                <Icons.BookOpen />
                            </div>
                        </div>
                        <h1 className="text-3xl font-bold text-slate-800 mb-2">نظم البيقنية</h1>
                        <p className="text-slate-500 mb-8 text-sm font-medium">للحفظ و الامتحان</p>
                        <div className="space-y-6 mb-8 text-left">
                            {/* Jumlah Soal */}
                            <div>
                                <label className="block text-xs font-bold text-slate-400 uppercase mb-2 tracking-wider">Jumlah Soal</label>
                                <div className="flex gap-2">
                                    {[5, 10, 20].map(n => (
                                        <PillOption key={n} label={n} selected={count === n} onClick={() => setCount(n)} />
                                    ))}
                                    <PillOption label="Semua" selected={count === 50} onClick={() => setCount(50)} />
                                </div>
                            </div>

                            {/* Timer Selection */}
                            <div>
                                <label className="block text-xs font-bold text-slate-400 uppercase mb-2 tracking-wider">Waktu per Soal (Detik)</label>
                                <div className="grid grid-cols-5 gap-2">
                                    {[10, 15, 20, 25, 30].map(t => (
                                        <button 
                                            key={t}
                                            onClick={() => setTimerDur(t)}
                                            className={`py-2 rounded-lg text-sm font-bold border ${timerDur === t ? 'bg-accent-500 text-white border-accent-500' : 'bg-white text-slate-500 border-slate-200'}`}
                                        >
                                            {t}
                                        </button>
                                    ))}
                                </div>
                            </div>

                            {/* Kategori */}
                            <div>
                                <label className="block text-xs font-bold text-slate-400 uppercase mb-2 tracking-wider">Kategori</label>
                                <div className="flex gap-2">
                                    <PillOption label="Semua" selected={type === 'all'} onClick={() => setType('all')} />
                                    <PillOption label="Nadzom" selected={type === 'nadzom'} onClick={() => setType('nadzom')} />
                                    <PillOption label="Ta'rif" selected={type === 'tarif'} onClick={() => setType('tarif')} />
                                </div>
                            </div>
                        </div>

                        <div className="space-y-3">
                            <Button onClick={() => onStart({count, type, timer: timerDur})} className="w-full text-lg shadow-lg shadow-primary-500/20" fullWidth>
                                Mulai Kuis
                            </Button>
                            <Button variant="secondary" onClick={onHifz} className="w-full" fullWidth>
                                Hafalan
                            </Button>
                        </div>
                    </div>
                </div>
            );
        };

        // 2. HIFZ VIEW (CHECKLIST)
        const HifzView = ({ onBack }) => {
            // Load state from localStorage
            const [memorized, setMemorized] = React.useState(() => {
                const saved = localStorage.getItem('baiquniyah_hifz');
                return saved ? JSON.parse(saved) : [];
            });

            React.useEffect(() => {
                localStorage.setItem('baiquniyah_hifz', JSON.stringify(memorized));
            }, [memorized]);

            const toggleMemorized = (id) => {
                setMemorized(prev => 
                    prev.includes(id) ? prev.filter(item => item !== id) : [...prev, id]
                );
            };

            const progress = Math.round((memorized.length / nadzomData.length) * 100);

            return (
                <div className="min-h-screen bg-slate-50 p-4 md:p-8 fade-enter-active">
                    <div className="max-w-3xl mx-auto pb-20">
                        {/* Header */}
                        <div className="flex flex-col gap-4 mb-6 sticky top-0 bg-slate-50/95 py-4 z-20 border-b border-slate-200 backdrop-blur-sm">
                            <div className="flex items-center justify-between">
                                <button onClick={onBack} className="flex items-center gap-2 text-slate-600 hover:text-primary-600 font-bold px-3 py-1 rounded-lg hover:bg-white transition-colors">
                                    <Icons.ChevronLeft /> Kembali
                                </button>
                                <h2 className="text-xl font-bold text-slate-800">Cek Hafalan</h2>
                            </div>
                            
                            {/* Progress Bar */}
                            <div className="bg-white p-4 rounded-2xl shadow-sm border border-slate-200">
                                <div className="flex justify-between text-sm font-bold text-slate-600 mb-2">
                                    <span>Progres Hafalan</span>
                                    <span className="text-primary-600">{memorized.length}/{nadzomData.length} ({progress}%)</span>
                                </div>
                                <div className="w-full bg-slate-100 rounded-full h-3 overflow-hidden">
                                    <div className="bg-primary-500 h-3 rounded-full transition-all duration-500" style={{width: `${progress}%`}}></div>
                                </div>
                            </div>
                        </div>

                        {/* List */}
                        <div className="space-y-4">
                            {nadzomData.map((verse) => {
                                const isChecked = memorized.includes(verse.id);
                                return (
                                    <div key={verse.id} className={`p-6 rounded-2xl border transition-all duration-300 ${isChecked ? 'bg-primary-50 border-primary-200 shadow-sm' : 'bg-white border-slate-200 hover:shadow-md'}`}>
                                        <div className="flex items-start gap-4">
                                            {/* Checkbox Wrapper */}
                                            <label className="checkbox-wrapper cursor-pointer relative pt-1">
                                                <input 
                                                    type="checkbox" 
                                                    className="hidden" 
                                                    checked={isChecked} 
                                                    onChange={() => toggleMemorized(verse.id)} 
                                                />
                                                <div className={`w-6 h-6 rounded-md border-2 flex items-center justify-center transition-colors ${isChecked ? 'bg-primary-500 border-primary-500' : 'border-slate-300 bg-slate-50'}`}>
                                                    <Icons.Check />
                                                </div>
                                            </label>

                                            <div className="flex-1">
                                                <div className="flex justify-between items-center mb-2">
                                                    <span className={`text-xs font-bold px-2 py-0.5 rounded ${isChecked ? 'bg-primary-200 text-primary-700' : 'bg-slate-100 text-slate-500'}`}>
                                                        Bait {verse.id}
                                                    </span>
                                                </div>
                                                <p className={`font-arabic text-2xl text-right mb-3 leading-loose ${isChecked ? 'text-primary-900' : 'text-slate-800'}`} dir="rtl">
                                                    {verse.ar}
                                                </p>
                                                <div className={`h-px w-full mb-3 ${isChecked ? 'bg-primary-200' : 'bg-slate-100'}`}></div>
                                                <p className={`text-sm italic ${isChecked ? 'text-primary-700' : 'text-slate-500'}`}>
                                                    {verse.tr}
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                </div>
            );
        };

        // 3. QUIZ VIEW
        const QuizView = ({ config, onFinish }) => {
            const [qIndex, setQIndex] = React.useState(0);
            const [score, setScore] = React.useState(0);
            const [shuffledQuestions, setShuffledQuestions] = React.useState([]);
            const [timerActive, setTimerActive] = React.useState(false);
            const [selectedOption, setSelectedOption] = React.useState(null);
            const [isAnswered, setIsAnswered] = React.useState(false);
            const [loading, setLoading] = React.useState(true);

            // Init Questions
            React.useEffect(() => {
                let filtered = questionsData;
                if(config.type !== 'all') {
                    filtered = questionsData.filter(q => q.type === config.type);
                }
                const shuffled = [...filtered].sort(() => 0.5 - Math.random());
                const limit = Math.min(config.count, shuffled.length);
                setShuffledQuestions(shuffled.slice(0, limit));
                setLoading(false);
                setTimerActive(true);
            }, [config]);

            const handleOptionClick = (opt) => {
                if (isAnswered) return;
                setTimerActive(false);
                setSelectedOption(opt);
                setIsAnswered(true);

                if (opt === shuffledQuestions[qIndex].answer) {
                    setScore(s => s + 1);
                }
            };

            const handleTimeUp = () => {
                if (isAnswered) return;
                setIsAnswered(true);
                setTimerActive(false);
            };

            const handleNext = () => {
                if (qIndex < shuffledQuestions.length - 1) {
                    setQIndex(prev => prev + 1);
                    setSelectedOption(null);
                    setIsAnswered(false);
                    setTimerActive(true);
                } else {
                    onFinish(score, shuffledQuestions.length);
                }
            };

            if (loading || shuffledQuestions.length === 0) return <div className="min-h-screen flex items-center justify-center text-slate-500">Memuat Soal...</div>;

            const currentQ = shuffledQuestions[qIndex];
            const isLast = qIndex === shuffledQuestions.length - 1;

            return (
                <div className="min-h-screen flex items-center justify-center p-4 fade-enter-active bg-slate-100">
                    <div className="w-full max-w-2xl">
                        {/* Header Stats */}
                        <div className="flex justify-between items-center mb-6 px-2">
                            <div className="flex flex-col">
                                <span className="text-xs font-bold text-slate-400 uppercase tracking-widest">Soal</span>
                                <span className="text-xl font-bold text-slate-700">{qIndex + 1} <span className="text-slate-400 text-sm">/ {shuffledQuestions.length}</span></span>
                            </div>
                            <Timer duration={config.timer} isActive={timerActive} onTimeUp={handleTimeUp} />
                        </div>

                        {/* Question Card */}
                        <div className="glass-card rounded-3xl p-6 md:p-10 mb-6 relative overflow-hidden bg-white">
                            {/* Progress Line */}
                            <div className="absolute top-0 left-0 h-1.5 bg-slate-100 w-full">
                                <div className="h-full bg-primary-500 transition-all duration-300" style={{width: `${((qIndex + 1) / shuffledQuestions.length) * 100}%`}}></div>
                            </div>

                            <div className="mt-4 mb-6">
                                <span className={`inline-block px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wider ${currentQ.type === 'nadzom' ? 'bg-blue-50 text-blue-600' : 'bg-orange-50 text-orange-600'}`}>
                                    {currentQ.type === 'nadzom' ? 'Sambung Ayat' : 'Definisi'}
                                </span>
                            </div>

                            <h3 className="font-arabic text-3xl md:text-4xl text-right mb-10 leading-relaxed text-slate-800" dir="rtl">
                                {currentQ.question}
                            </h3>

                            <div className="space-y-3">
                                {currentQ.options.map((opt, i) => {
                                    let btnClass = "w-full p-4 md:p-5 rounded-2xl text-right font-arabic text-xl border-2 transition-all duration-200 outline-none ";
                                    
                                    if (isAnswered) {
                                        if (opt === currentQ.answer) {
                                            btnClass += "border-primary-500 bg-primary-50 text-primary-700 shadow-[0_0_0_1px_#10b981]"; 
                                        } else if (opt === selectedOption) {
                                            btnClass += "border-red-400 bg-red-50 text-red-600";
                                        } else {
                                            btnClass += "border-slate-100 text-slate-300 opacity-50"; 
                                        }
                                    } else {
                                        btnClass += "border-slate-200 bg-white hover:border-primary-400 hover:bg-slate-50 text-slate-700 hover:shadow-md";
                                    }

                                    return (
                                        <button 
                                            key={i} 
                                            onClick={() => handleOptionClick(opt)}
                                            className={btnClass}
                                            dir="rtl"
                                            disabled={isAnswered}
                                        >
                                            {opt}
                                        </button>
                                    );
                                })}
                            </div>
                        </div>

                        {/* Footer Action */}
                        <div className="h-16 flex justify-end">
                            {isAnswered && (
                                <Button onClick={handleNext} className="px-8 text-lg shadow-xl shadow-primary-500/20 animate-bounce">
                                    {isLast ? "Lihat Hasil" : "Lanjut"} <Icons.Play />
                                </Button>
                            )}
                        </div>
                    </div>
                </div>
            );
        };

        // 4. RESULT VIEW
        const ResultView = ({ score, total, onRestart }) => {
            const percentage = Math.round((score / total) * 100);
            let message = "Jangan Menyerah!";
            let iconColor = "text-red-500 bg-red-100";
            
            if(percentage === 100) { message = "Mumtaz! Sempurna!"; iconColor = "text-primary-600 bg-primary-100"; }
            else if(percentage >= 80) { message = "Jayyid Jiddan!"; iconColor = "text-primary-500 bg-primary-50"; }
            else if(percentage >= 60) { message = "Jayyid! (Baik)"; iconColor = "text-blue-500 bg-blue-50"; }
            
            return (
                <div className="min-h-screen flex items-center justify-center p-6 fade-enter-active">
                    <div className="w-full max-w-md bg-white rounded-3xl shadow-xl p-10 text-center">
                        <div className={`mb-6 inline-flex p-5 rounded-full ${iconColor} mb-6`}>
                             <Icons.CheckCircle />
                        </div>
                        
                        <h2 className="text-6xl font-extrabold text-slate-800 mb-2">{score}<span className="text-3xl text-slate-300">/{total}</span></h2>
                        <p className="text-xl font-bold text-slate-700 mb-1">{message}</p>
                        <p className="text-slate-400 mb-10 text-sm">Skor Akhir</p>

                        <div className="bg-slate-50 rounded-2xl p-6 mb-8 border border-slate-100">
                            <div className="flex justify-between text-xs font-bold text-slate-400 uppercase mb-2">
                                <span>Akurasi</span>
                                <span>{percentage}%</span>
                            </div>
                            <div className="w-full bg-slate-200 rounded-full h-3 mb-2 overflow-hidden">
                                <div className={`h-3 rounded-full transition-all duration-1000 ${percentage >= 60 ? 'bg-primary-500' : 'bg-red-400'}`} style={{width: `${percentage}%`}}></div>
                            </div>
                        </div>

                        <Button onClick={onRestart} className="w-full" fullWidth>
                            Mulai lagi
                        </Button>
                    </div>
                </div>
            );
        };

        // --- MAIN APP ---

        const App = () => {
            const [view, setView] = React.useState('home');
            const [quizConfig, setQuizConfig] = React.useState(null);
            const [scoreData, setScoreData] = React.useState({score:0, total:0});

            return (
                <>
                    {view === 'home' && (
                        <HomeView 
                            onStart={(config) => { 
                                setQuizConfig(config); 
                                setView('quiz'); 
                            }} 
                            onHifz={() => setView('hifz')} 
                        />
                    )}
                    
                    {view === 'quiz' && (
                        <QuizView 
                            config={quizConfig}
                            onFinish={(s, t) => { 
                                setScoreData({score: s, total: t}); 
                                setView('result'); 
                            }} 
                        />
                    )}
                    
                    {view === 'hifz' && <HifzView onBack={() => setView('home')} />}
                    
                    {view === 'result' && (
                        <ResultView 
                            score={scoreData.score} 
                            total={scoreData.total} 
                            onRestart={() => setView('home')} 
                        />
                    )}
                </>
            );
        };

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>
